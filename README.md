Make a kubernetes loadbalancer(ELB) in AWS from vagrant
==========================================================================

# Features
```
	1. Make a node app on docker hub
	2. Make an elb for a K8S master and two nodes in AWS through kubectl, kops and awscli
	3. Set firewall and a service domain in Route53 through awscli
	4. Install K8S admin UI
```

# Preparations
```
	1. Make a sub domain in route53 ex) topzone.biz
		dig NS topzone.biz

 	2. Add an aws user with permissions
		AmazonEC2FullAccess
		AmazonRoute53FullAccess
		AmazonS3FullAccess
		IAMFullAccess
		AmazonVPCFullAccess
	
	3. Set AWS access key
		vi ~/tz-kubernetes/etc/.aws/config	
		vi ~/tz-kubernetes/etc/.aws/credentials
		
		* Check available aws zone
		  aws ec2 describe-availability-zones --region us-west-1
		  
	4. Make s3
		vi ~/scripts/elb.sh
		aws s3api create-bucket --bucket kops-state-tz
		
	5. change your docker_hub id / password
		* https://hub.docker.com
		vi ~/scripts/docker.sh
		docker login -u doohee323 -p 1234
```

# Execution
```
	vagrant up
	#vagrant destroy -f && vagrant up
	#vagrant provision
	#vagrant ssh
	
	# log
	vi ./exec.log
```

# Run
```
	- Access to node in docker from host 
 		curl http://192.168.82.171:49160
 	- Access to aws elb which is generated by k8s
 		curl http://test.nextransfer.com

	- K8S UI
```

# Remove All resources in AWS
```
	vagrant ssh
	kops delete cluster --name topzone.biz --yes --state=s3://kops-state-tz
```

# Improvement
```
	You can improve all script using a env. file. Not implemented yet.  
		vi ./etc/env.properties
```


